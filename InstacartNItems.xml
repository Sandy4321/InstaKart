<note>Predict Number of Reordered Items in a basket</note>
<base table="dp.users.filipp.instacart.combined_prior_train"/>
<willbe name="n_basket_items" value="g_cnt(user_id order_id;reordered)"/>
<willbe name="avg_basket" value="g_avg(user_id;;n_basket_items)"/>
<willbe name="std_basket" value="g_std(user_id;;n_basket_items)"/>
<note type="link">The following link is to table: All Databases/Data Partnerships/User Folders/Filip P/Instacart Kaggle/DOW_Hour_Enum</note>
<link table2="dp.users.filipp.instacart.dow_hour_enum" col="order_dow,order_hour_of_day" cols="hour_day_bucket" col2="order_dow,order_hour_of_day" shift="0"/>
<for i="0" to="3">
  <willbe name="sel_bucket_{@i}" value="hour_day_bucket={@i}"/>
  <willbe name="avg_time_bucket_basket_{@i}" value="ifnull(g_avg(user_id;sel_bucket_{@i};n_basket_items);0)"/>
  <colord hide="sel_bucket_{@i}" hard="1"/>
</for>
<colord cols="order_id,user_id,eval_set,order_dow,order_hour_of_day,days_since_prior_order,n_basket_items,avg_basket,hour_day_bucket,avg_time_bucket_basket_0,avg_time_bucket_basket_1,avg_time_bucket_basket_2,avg_time_bucket_basket_3"/>
<sel value="eval_set='train'"/>
<sel value="g_first1(user_id order_id;;)"/>